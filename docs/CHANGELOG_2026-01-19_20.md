# Changelog: 19.-20. Januar 2026

## Ãœbersicht

Umfassende Arbeiten am QR-Designer (QR-Styler), Einladungs-Wizard, Live-Wall, PWA-Features und diverse Bugfixes fÃ¼r die GÃ¤stefotos-Plattform.

---

## ðŸŽ¨ QR-Designer / QR-Styler (Print Service Integration)

### Technisch

**Neue Features:**
- Print Service Integration fÃ¼r direkten QR-Code-Druck Ã¼ber WordPress/WooCommerce
- Logo-Upload fÃ¼r QR-Codes mit SeaweedFS-Integration
- QR-Design-Vorlagen mit Farbschemata (Classic Rose, Rose Gold, Champagne, Lavender, etc.)
- Preis-Anzeige fÃ¼r Print-Service aus WooCommerce
- Checkout-Button fÃ¼r direkten Bestellprozess

**Neue Dateien:**
- `packages/backend/src/routes/printService.ts` - Backend-Routes fÃ¼r Print-Service
- `packages/frontend/src/components/qr-designer/LogoUpload.tsx` - Logo-Upload-Komponente
- `packages/frontend/src/app/(admin)/dashboard/print-service/page.tsx` - Admin-Einstellungen
- `docs/DRUCKSERVICE_INTEGRATION_PLAN.md` - Technische Dokumentation

**Datenbank:**
- Neue Prisma-Modelle: `PrintServiceSettings`, `QrDesign`
- Felder: `wpUrl`, `wpUsername`, `wpPassword`, `productId`, `isActive`, etc.

**GeÃ¤nderte Dateien:**
- `packages/frontend/src/app/events/[id]/qr-styler/page.tsx`
  - Print-Service-Button integriert
  - Logo-Upload-Komponente eingebunden
  - Preis-Anzeige aus WooCommerce-API

- `packages/backend/src/routes/events.ts`
  - QR-Logo-Upload-Route (`/:id/qr/logo`)
  - QR-Design speichern (`/:id/save-design`)
  - Bugfixes: `uploadFile` Call Signature korrigiert

**Backend-Integration:**
- WordPress-Authentifizierung Ã¼ber Application Password
- WooCommerce REST API Integration fÃ¼r Produktpreise
- Automatischer Checkout-URL-Generator mit Event-Daten

### Laiensicher erklÃ¤rt

**Was ist das?**
Der QR-Designer ist eine neue Funktion, mit der Event-Hosts schÃ¶ne, personalisierte QR-Codes fÃ¼r ihre Events erstellen kÃ¶nnen.

**Was kann man damit machen?**
- Eigenes Logo auf den QR-Code hochladen
- Aus verschiedenen Farbschemata wÃ¤hlen (Rose, Gold, Lavendel, etc.)
- QR-Codes direkt als physische Karten bestellen (Print-Service)
- Preis wird automatisch aus dem Shop geholt

**Wo findet man das?**
Dashboard â†’ Footer â†’ "QR-Designer" Button

---

## âœ‰ï¸ Einladungs-Wizard (Invitation)

### Technisch

**Route:** `/events/[id]/invitation`

**Features:**
- Wizard-basiertes UI fÃ¼r Einladungserstellung
- Integration mit Event-Daten (Titel, Datum, Ort)
- Vorschau der Einladung
- Export-Funktionen

**GeÃ¤nderte Dateien:**
- Footer-Navigation aktualisiert (BottomNavigation.tsx, DashboardFooter.tsx)
- Wizard-Mode Links in `categories/page.tsx`

### Laiensicher erklÃ¤rt

Der Einladungs-Wizard hilft Event-Hosts, professionelle Einladungen fÃ¼r ihre GÃ¤ste zu erstellen. Alle Event-Infos werden automatisch eingefÃ¼gt.

---

## ðŸ–¼ï¸ Live-Wall Feature

### Technisch

**Neue Datei:**
- `packages/frontend/src/app/events/[id]/live-wall/page.tsx`

**Features:**
- Responsive Masonry-Grid fÃ¼r Foto-Anzeige
- Auto-Refresh alle 30 Sekunden
- Filter: Alle Fotos / GÃ¤stebuch / Challenges / Stories
- Fullscreen-Modus
- Share-Funktion
- QR-Code-Anzeige fÃ¼r Event-Link
- Countdown bis Event-Start/Ende
- Animierte ÃœbergÃ¤nge (Framer Motion)

**Dashboard-Integration:**
- Neuer "Live-Wall" Button im Event-Dashboard
- Monitor-Icon (Lucide React)

**Dokumentation:**
- `docs/LIVE_WALL_FEATURE.md`

### Laiensicher erklÃ¤rt

**Was ist die Live-Wall?**
Eine groÃŸe Foto-Wand, die alle Event-Fotos in Echtzeit anzeigt. Perfekt fÃ¼r Beamer oder groÃŸe Bildschirme bei Events.

**Features:**
- Aktualisiert sich automatisch alle 30 Sekunden
- Filter nach Foto-Typ (GÃ¤stebuch, Challenges, etc.)
- Countdown bis Event-Start
- QR-Code zum einfachen Beitreten

**Wo findet man das?**
Dashboard â†’ "Live-Wall" Button

---

## ðŸ“± PWA (Progressive Web App) Features

### Technisch

**Neue Dateien:**
- `packages/frontend/src/components/InstallPrompt.tsx`

**Features:**
- "Add to Homescreen" Prompt fÃ¼r iOS, Android, Desktop
- Platform-spezifische Anweisungen
- 7-Tage Cooldown bei Dismissal
- Sticky Bottom-Banner mit Animations (Framer Motion)

**Manifest Updates:**
- `packages/frontend/public/manifest.json`
- Neue Felder: `categories`, `shortcuts`, `screenshots`
- Icon-Purposes: `any`, `maskable`

**Integration:**
- GÃ¤steseite (`/e/[slug]/page.tsx`)
- Dashboard (`/events/[id]/dashboard/page.tsx`)

### Laiensicher erklÃ¤rt

Die App kann jetzt auf dem Smartphone wie eine "echte" App installiert werden. Benutzer sehen einen freundlichen Hinweis mit Anleitung, wie sie die App zum Home-Screen hinzufÃ¼gen kÃ¶nnen.

---

## ðŸ“¸ GÃ¤stebuch-Features

### Technisch

**Neue Dateien:**
- `packages/frontend/src/components/Guestbook.tsx`
- `packages/frontend/src/app/events/[id]/guestbook/page.tsx`

**Features:**
- Text-EintrÃ¤ge mit Foto und Audio
- Moderation (PENDING, APPROVED, REJECTED)
- Host-Nachricht bearbeitbar
- Visuelle Badges auf Fotos im Grid
- `isGuestbookEntry` Flag fÃ¼r Foto-Metadaten

**ModernPhotoGrid Updates:**
- GÃ¤stebuch-Overlay mit MessageCircle-Icon
- Immer sichtbar auf Grid-Items

### Laiensicher erklÃ¤rt

GÃ¤ste kÃ¶nnen jetzt GÃ¤stebuch-EintrÃ¤ge mit Fotos, Text und sogar Sprachnachrichten hinterlassen. Hosts kÃ¶nnen EintrÃ¤ge moderieren, bevor sie Ã¶ffentlich sichtbar werden.

---

## ðŸ¤³ Photo-Booth Backend-Routes

### Technisch

**Neue Datei:**
- `packages/backend/src/routes/photobooth.ts`

**Features:**
- Photo-Booth Session Management
- Auto-Approval fÃ¼r Booth-Fotos
- Upload-Statistiken
- Event-Ownership-Checks

**Integration:**
- `packages/backend/src/index.ts` - Route mounted unter `/api/photobooth`

### Laiensicher erklÃ¤rt

Backend-Infrastruktur fÃ¼r zukÃ¼nftige Photo-Booth-Integration (z.B. fÃ¼r Selfie-Stationen bei Events).

---

## ðŸ› Bugfixes & Optimierungen

### 1. Frontend Chunk Loading Errors (404)

**Problem:**
- Next.js Chunks wurden nicht geladen (404 Fehler)
- MIME-Type Fehler ('text/plain' statt 'application/javascript')

**LÃ¶sung:**
- Frontend komplett neu gebaut (Clean Build)
- `.next` Ordner gelÃ¶scht
- Service neu gestartet
- Browser-Cache-Hinweise fÃ¼r User

### 2. Nginx Caching

**Problem:**
- `Cache-Control: no-cache` Header verhinderten Cloudflare-Caching
- Langsame Ladezeiten trotz Next.js-Cache

**LÃ¶sung:**
- `/etc/nginx/sites-enabled/gaestefotos-v2.conf` - Cache-Header entfernt
- Cloudflare kann jetzt cachen

### 3. Footer-Navigation Routes

**Problem:**
- Footer zeigte noch alte `/design` Route statt neue `/qr-styler` Route
- User landete auf alter Design-Seite

**LÃ¶sung:**
- `packages/frontend/src/components/DashboardFooter.tsx`
  - "Design" â†’ "QR-Designer"
  - Icon: Palette â†’ Sparkles
  - Route: `/events/{id}/design` â†’ `/events/{id}/qr-styler`

- `packages/frontend/src/components/BottomNavigation.tsx`
  - QR-Designer Button hinzugefÃ¼gt (fÃ¼r Hosts)
  - Einladung Button hinzugefÃ¼gt (fÃ¼r Hosts)

- `packages/frontend/src/app/events/[id]/categories/page.tsx`
  - Wizard-Links: `/design?wizard=1` â†’ `/qr-styler?wizard=1`

### 4. Build-Fehler (Syntax Errors)

**Problem:**
- JSX-Syntax-Fehler in BottomNavigation.tsx
- Mehrfache gescheiterte Edits

**LÃ¶sung:**
- Datei mit `git checkout` zurÃ¼ckgesetzt
- Saubere Edits mit korrekter JSX-Struktur
- Duplikat-Imports entfernt (Sparkles, Mail)

---

## ðŸ“‹ Route-Dokumentation

**Neue Datei:**
- `ROUTES_OVERVIEW.md` - Komplette Ãœbersicht aller Routes (alt vs. neu)

**Inhalt:**
- Guest Routes
- Host Routes
- Admin Routes
- Migration Guide
- Changelog

---

## ðŸ—‚ï¸ Zusammenfassung der geÃ¤nderten Dateien

### Backend
- `packages/backend/src/routes/events.ts`
- `packages/backend/src/routes/printService.ts` (NEU)
- `packages/backend/src/routes/photobooth.ts` (NEU)
- `packages/backend/src/index.ts`
- `packages/backend/prisma/schema.prisma`
- `packages/backend/.env.example`

### Frontend
- `packages/frontend/src/app/events/[id]/qr-styler/page.tsx`
- `packages/frontend/src/app/events/[id]/invitation/page.tsx`
- `packages/frontend/src/app/events/[id]/live-wall/page.tsx` (NEU)
- `packages/frontend/src/app/events/[id]/guestbook/page.tsx` (NEU)
- `packages/frontend/src/app/events/[id]/dashboard/page.tsx`
- `packages/frontend/src/app/events/[id]/categories/page.tsx`
- `packages/frontend/src/app/(admin)/dashboard/print-service/page.tsx` (NEU)
- `packages/frontend/src/app/e/[slug]/page.tsx`
- `packages/frontend/src/components/BottomNavigation.tsx`
- `packages/frontend/src/components/DashboardFooter.tsx`
- `packages/frontend/src/components/EventHeader.tsx`
- `packages/frontend/src/components/ModernPhotoGrid.tsx`
- `packages/frontend/src/components/Guestbook.tsx` (NEU)
- `packages/frontend/src/components/InstallPrompt.tsx` (NEU)
- `packages/frontend/src/components/qr-designer/LogoUpload.tsx` (NEU)
- `packages/frontend/public/manifest.json`

### Infrastruktur
- `/etc/nginx/sites-enabled/gaestefotos-v2.conf`
- `/etc/systemd/system/gaestefotos-frontend.service`

### Dokumentation
- `docs/DRUCKSERVICE_INTEGRATION_PLAN.md` (NEU)
- `docs/LIVE_WALL_FEATURE.md` (NEU)
- `ROUTES_OVERVIEW.md` (NEU)

---

## ðŸŽ¯ NÃ¤chste Schritte / Offene Punkte

1. **Browser-Cache-Hinweis fÃ¼r User:**
   - Nach jedem Deploy sollten User STRG+SHIFT+DEL drÃ¼cken
   - Oder Cloudflare "Purge Everything" nutzen

2. **Print-Service Testing:**
   - WordPress/WooCommerce-Integration testen
   - Checkout-Flow durchspielen
   - Produktpreis-Anzeige verifizieren

3. **PWA-Testing:**
   - iOS Safari testen
   - Android Chrome testen
   - Desktop-Installation testen

4. **Live-Wall Optimierungen:**
   - Performance bei vielen Fotos (>100)
   - Auto-Refresh Interval konfigurierbar machen

---

## ðŸ“Š Technische Metriken

- **Neue Dateien:** 12
- **GeÃ¤nderte Dateien:** 23
- **Neue Backend-Routes:** 3 (printService, photobooth, QR-Logo)
- **Neue Features:** 6 (QR-Styler Print, Live-Wall, Guestbook, PWA, Photo-Booth, Einladung)
- **Bugfixes:** 4 (Chunks, Nginx, Routes, JSX-Syntax)
- **Build-Zeit:** ~5-7 Sekunden
- **Neue Prisma-Modelle:** 2 (PrintServiceSettings, QrDesign)

---

## ðŸ”§ Entwickler-Notizen

### Build-Prozess
```bash
cd /root/gaestefotos-app-v2/packages/frontend
rm -rf .next
pnpm build
systemctl restart gaestefotos-frontend
```

### Git-Reset bei Problemen
```bash
cd /root/gaestefotos-app-v2
git checkout packages/frontend/src/components/BottomNavigation.tsx
```

### Nginx-Test
```bash
nginx -t
systemctl reload nginx
```

### Cloudflare Cache Purge
Dashboard â†’ Domain â†’ Caching â†’ "Purge Everything"

---

**Erstellt:** 20. Januar 2026, 23:40 Uhr  
**Autor:** Cascade AI Assistant  
**Version:** 1.0
